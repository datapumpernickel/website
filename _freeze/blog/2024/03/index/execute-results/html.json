{
  "hash": "822913b92e929997f701933cc660b819",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Part I: Who wrote the last coalition agreement in Germany?\"\ndate: 2024-11-30\ndescription: \"Using embeddings and cosine similarity, comparing the coalition agreement with party programs, I try to determine who wrote the largest part of the last coalition agreement.\"\nimage: \"index_files/figure-html/fig-1-density-plot-1.png\"\ncategories:\n  - r\n  - python\n  - sentence-transformer\n  - nlp\nformat:\n  html: \n    shift-heading-level-by: 1\ninclude-before-body:\n  text: |\n    <style>\n      .no-stripe .gt_table tr.odd {\n        --bs-table-striped-bg: transparent;\n      }\n      \n      .gt_footnote {\n        text-align: left !important;\n      }\n    </style>\ncitation: true\nbibliography: references.bib\nexecute:\n  enabled: true\n---\n\n\n\n\n\n## The idea\n\nIn the following blog entry, I will try to find out which of the parties taking part in the recently broken up coalition wrote which part of the agreement that now lies in shambles. For that I will read out the party programs of each party, embed them together with the coalition agreement in a common vector space and calculate a sentence-wise cosine-similarity. This allows us to find for each sentence in the coalition agreement the most similar sentence in each party program. \n\nPart II will look at whether the content of the sentences that we can attribute to single parties lies in what we would determine to be their core-issues, such as ecology for the greens. For that we will us a pretrained transformer model of the manifesto project to classify all sentences of the agreement. \n\n## Why are coalition agreements important?\n\nIn Germany, two factors make it a frequent phenomenon that coalitions of different parties govern the country. Firstly, Germany has a proportional voting system, following the decades old Duverger´s law making it a candidate for a more or less fragmented multi-party system [@Chapman1955], hence seldomly does one party gain a majority to govern with sovereignty, and secondly, Germany is a parlamentarian government system, which makes functioning governments without a majority in the legislative chamber unlikely [@Steffani1979]. Hence, multiple parties need to agree on a coalition to establish a majority to form a government. \n\nThe coalition agreement is a legally non-binding contract between the participating parties as to which legislative projects they are going to develop in the years they will govern together. It also establishes the division of portfolios, which parties gets which ministries. We will focus on the content of the coalition agreement and try to see, which party might have \"dominated\" the coalition agreement in terms of textual contributions and similarity to their party program. \n\nThere is obvious limits to this, as we can establish textual similarity, but we cannot establish the importance of given sentences. Having introduced a sentence that promises to \"*make state actions more efficient and faster*\" (Wir wollen staatliches Handeln schneller und effektiver machen und besser auf künftige Krisen\nvorbereiten., p.5) is clearly not as significant as a sentence that reads: \"*We want 30 percent organic farming by 2030*\" (Wir wollen 30 Prozent Ökolandbau bis zum Jahr 2030 erreichen., p. 46), which includes a very tangible goal. \n\n\n\n\n\n\n\n\n## Reading in the PDFs\n\nWe are going to read in the texts, using the `tabulapdf` package, because it does a really good job at detecting and correctly reading in two-column pdfs. We do some basic cleaning, taking out some PDF footnotes, headers and repeating titles that are not very interesting to us. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n## get a list of pdf files\npdfs <- list.files('raw_data', full.names = T, pattern = \".pdf\")\n\n## read in each of the pdfs\ntexts <-\n  map_dfr(pdfs, ~ {\n    tabulapdf::extract_text(.x) %>% tibble(text = ., party = .x)\n  })\n\nclean_text <- function(text) {\n  # First, replace only the problematic \"- \" cases with a placeholder\n  text <- str_replace_all(text, \"- (?=[a-z])\", \"PLACEHOLDER\")\n  \n  # Restore legitimate cases where it should be retained\n  text <- str_replace_all(text, \"PLACEHOLDER(?=als\\\\b|auch\\\\b|sondern\\\\b|oder\\\\b|noch\\\\b|wie\\\\b|und\\\\b)\", \"- \")\n  \n  # Remove the placeholder from other positions\n  text <- str_replace_all(text, \"PLACEHOLDER\", \"\")\n  \n  return(text)\n}\n\ntexts_clean <- texts %>%\n  mutate(text = str_squish(text) |> \n           str_trim() |> \n           str_remove_all('Bereit, weil Ihr es seid.') |> \n           str_remove_all('Bundestagswahlprogramm 2021') |> \n           str_remove_all('Das Zukunftsprogramm der SPD') |> \n           str_remove_all('BÜNDNIS 90 / DIE GRÜNEN') |> \n           str_remove_all('SPD-Parteivorstand 2021') |> \n           clean_text()\n  ) %>%\n  mutate(party = str_remove_all(party, '^raw_data/') %>% str_remove(.,'\\\\.pdf'))\n\ntexts_collapsed <- texts_clean %>%\n  group_by(party) %>%\n  summarise(text = paste0(text, collapse = ' '))\n```\n:::\n\n\n\n### Frequent words \n\nHaving these party programs in theory allows for a myriad of different interesting metrics, like how diverse is their vocabulary, how complicated is their language, how is their readibility rated, which topics are most prominently present and uncountable possibilities more. We are just going to look at the most frequent words to get a feel for the documents and some obvious differences in language between the parties. \n\n**Gendering:** the first thing that is very evident, is the fact that \"innen\" is such a prominent word for SPD and GRUENE, but not for the FDP. This is not related to some form of domestic politics or inner-something, but the fact that SPD and GRUENE use gender-sensitive language, accounting for all genders in the word \"citizen\" in german reads as follow: \"Bürger:innen\" or \"Bürger*innen\". \n\n**Fordern vs Fördern** Words that seem similar, but are very different. The FDP puts an emphasis on \"fordern\", which means \"demanding\", whereas SPD and GRUENE put a stronger emphasis on \"Fördern\", so \"promote\" or \"foster\". \n\nAlso tipical and something we would expect from the small government promoters FDP is the focus on companies, or \"Unternehmen\". \n\n**EU vs europäisch vs. Europa** The difference in the most frequent reference to the European Union versus the idea of a european identity also seems worth mentioning. \n\nAll these observations need to be interpreted with care though, just looking at the (relative) frequency of words, can bear little meaning, but it gives us a feeling for the policy documents we are looking at. \n\n\n::: {.panel-tabset}\n\n## Plot\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Most frequent word in party programs](index_files/figure-html/fig-1-freq_words-1.png){#fig-1-freq_words fig-align='center' width=90%}\n:::\n:::\n\n\n## Code\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n\nlibrary(ggplot2)\nlibrary(tidytext)\n\ncorpus <- corpus(texts_collapsed)\n\ndocnames(corpus) <- texts_collapsed$party\n\ntokens <- tokens(corpus, remove_punct = T) %>%\n  tokens_remove(stopwords::stopwords('de'))\n\ndfm <- dfm(tokens)\n\nexcluded_words <- c(\"ka\", \"pi\",\"te\",\"l\", \">\", \"2021\", \"f\", \"ff\", \"seite\", \"kapitel\", \"dass\",\"ab\", \"demokraten\", \"freie\")\n\nfreq <- quanteda.textstats::textstat_frequency(dfm, group= party) |> \n  filter(!feature %in% excluded_words) |> \n  slice_max(order_by = frequency, n = 15,by = group) \n\n# Prepare the data for plotting\nplot_data <- freq %>%\n  arrange(group, desc(frequency)) |> \n  filter(!group ==\"koalition\")\n\n# Plot\nggplot(plot_data, aes(frequency, reorder_within(feature, frequency, group), fill = group)) +\n  geom_col(show.legend = FALSE) +\n  geom_label(\n    aes(label = feature),\n    label.size = NA,\n    color = \"white\",\n    fontface = \"bold\",\n    size = 5,\n    position = position_stack(vjust = 0.5),\n    show.legend = FALSE\n  ) +\n  scale_y_reordered() +\n  facet_wrap(~ toupper(group), scales = \"free\", ncol = 3) +\n  theme_minimal(base_size = 14) +\n  theme(\n    strip.text = element_text(face = \"bold\"),\n    panel.spacing = unit(1, \"lines\"),\n    axis.text.y = element_blank(),\n    axis.ticks = element_blank(),\n    axis.title = element_blank(),\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    panel.grid.major.y = element_blank(), # Remove vertical grid lines\n    panel.grid.minor.y = element_blank() # Remove minor grid lines\n  )+\n  scale_fill_manual(values = list(\n    \"fdp\" = paletteer::paletteer_d(\"LaCroixColoR::Pamplemousse\")[3],\n    \"gruene\" = paletteer::paletteer_d(\"LaCroixColoR::Pamplemousse\")[4],\n    \"spd\" = paletteer::paletteer_d(\"LaCroixColoR::Pamplemousse\")[1]\n  )) +\n  labs(caption = glue(\"Excluded the words: {paste0(excluded_words, collapse = ', ')}\") |> str_wrap(50))\n```\n:::\n\n\n:::\n\n\n\n\n\n<!-- ```{r} -->\n<!-- quanteda.textstats::textstat_simil(dfm, method = 'jaccard',margin = \"documents\") -->\n<!-- ``` -->\n\n### Splitting sentences\nIn the next step, since we want to determine authorship on the sentence-level, we need to split the entire text into single sentences. The `tidytext` package has a handy function for this, it is as simple as the following: \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsentences <- texts_clean |> \n  tidytext::unnest_sentences(output = \"text\", ## specify the name of the output column\n                             input = \"text\")  ## specify the name of the input column\n\n```\n:::\n\n\n\n\nWe can make a quick descriptive table, comparing the **length of each single document** in terms of sentences and see that the program of the greens is by far the longest (in terms of sentences). \n\n::: {.panel-tabset}\n\n## Table\n\n\n::: {#tbl-sentence_count-table .cell layout-align=\"center\" tbl-cap='Sentence Counts'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"xuqtxzurgy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xuqtxzurgy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xuqtxzurgy thead, #xuqtxzurgy tbody, #xuqtxzurgy tfoot, #xuqtxzurgy tr, #xuqtxzurgy td, #xuqtxzurgy th {\n  border-style: none;\n}\n\n#xuqtxzurgy p {\n  margin: 0;\n  padding: 0;\n}\n\n#xuqtxzurgy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xuqtxzurgy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xuqtxzurgy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xuqtxzurgy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xuqtxzurgy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xuqtxzurgy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xuqtxzurgy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xuqtxzurgy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xuqtxzurgy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xuqtxzurgy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xuqtxzurgy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xuqtxzurgy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xuqtxzurgy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xuqtxzurgy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xuqtxzurgy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xuqtxzurgy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xuqtxzurgy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xuqtxzurgy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xuqtxzurgy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xuqtxzurgy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xuqtxzurgy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xuqtxzurgy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xuqtxzurgy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xuqtxzurgy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xuqtxzurgy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xuqtxzurgy .gt_left {\n  text-align: left;\n}\n\n#xuqtxzurgy .gt_center {\n  text-align: center;\n}\n\n#xuqtxzurgy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xuqtxzurgy .gt_font_normal {\n  font-weight: normal;\n}\n\n#xuqtxzurgy .gt_font_bold {\n  font-weight: bold;\n}\n\n#xuqtxzurgy .gt_font_italic {\n  font-style: italic;\n}\n\n#xuqtxzurgy .gt_super {\n  font-size: 65%;\n}\n\n#xuqtxzurgy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xuqtxzurgy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xuqtxzurgy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xuqtxzurgy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xuqtxzurgy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xuqtxzurgy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xuqtxzurgy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#xuqtxzurgy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#xuqtxzurgy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal\" style><span data-qmd-base64=\"PHN0cm9uZz5TZW50ZW5jZSBDb3VudDwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Sentence Count</strong></span></span></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>by document</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"party\">Document</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Sentence Count</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DUPE_COLUMN_PLT\">n</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE Wahlprogramm</td>\n<td headers=\"n\" class=\"gt_row gt_right\">3725</td>\n<td headers=\"DUPE_COLUMN_PLT\" class=\"gt_row gt_left\"><?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='113.39pt' height='14.17pt' viewBox='0 0 113.39 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw=='>    <rect x='0.00' y='0.00' width='113.39' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw==)'><rect x='5.02' y='0.89' width='98.37' height='12.40' style='stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #088BBE;' /><line x1='5.02' y1='14.17' x2='5.02' y2='0.0000000000000016' style='stroke-width: 1.07; stroke-linecap: butt;' /></g></svg></td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">Koalitionsvertrag</td>\n<td headers=\"n\" class=\"gt_row gt_right\">3257</td>\n<td headers=\"DUPE_COLUMN_PLT\" class=\"gt_row gt_left\"><?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='113.39pt' height='14.17pt' viewBox='0 0 113.39 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw=='>    <rect x='0.00' y='0.00' width='113.39' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw==)'><rect x='5.02' y='0.89' width='86.01' height='12.40' style='stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #088BBE;' /><line x1='5.02' y1='14.17' x2='5.02' y2='0.0000000000000016' style='stroke-width: 1.07; stroke-linecap: butt;' /></g></svg></td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP Wahlprogramm</td>\n<td headers=\"n\" class=\"gt_row gt_right\">2247</td>\n<td headers=\"DUPE_COLUMN_PLT\" class=\"gt_row gt_left\"><?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='113.39pt' height='14.17pt' viewBox='0 0 113.39 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw=='>    <rect x='0.00' y='0.00' width='113.39' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw==)'><rect x='5.02' y='0.89' width='59.34' height='12.40' style='stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #088BBE;' /><line x1='5.02' y1='14.17' x2='5.02' y2='0.0000000000000016' style='stroke-width: 1.07; stroke-linecap: butt;' /></g></svg></td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD Wahlprogramm</td>\n<td headers=\"n\" class=\"gt_row gt_right\">1577</td>\n<td headers=\"DUPE_COLUMN_PLT\" class=\"gt_row gt_left\"><?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='113.39pt' height='14.17pt' viewBox='0 0 113.39 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw=='>    <rect x='0.00' y='0.00' width='113.39' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHwxMTMuMzl8MC4wMHwxNC4xNw==)'><rect x='5.02' y='0.89' width='41.65' height='12.40' style='stroke-width: 1.07; stroke: none; stroke-linecap: butt; stroke-linejoin: miter; fill: #088BBE;' /><line x1='5.02' y1='14.17' x2='5.02' y2='0.0000000000000016' style='stroke-width: 1.07; stroke-linecap: butt;' /></g></svg></td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"3\"> <span data-qmd-base64=\"PGVtPkV4dHJhY3RlZCB3aXRoIHRhYnVsYXBkZiBhbmQgdG9rZW5pemVkIGludG8gc2VudGVuY2VzIHdpdGggdGlkeXRleHQ8L2VtPg==\"><span class='gt_from_md'><em>Extracted with tabulapdf and tokenized into sentences with tidytext</em></span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Code\n\n\n::: {#tbl-sentence_count-code .cell layout-align=\"center\" tbl-cap='Sentence Counts'}\n\n```{.r .cell-code}\nsentences |>\n  count(party) |>\n  arrange(desc(n)) |>\n  mutate(party = if_else(\n    party == \"koalition\",\n    \"Koalitionsvertrag\",\n    str_c(toupper(party), \" Wahlprogramm\")\n  )) |>\n  gt() |>\n  gt::tab_header(title = md(\"**Sentence Count**\"), subtitle = \"by document\") |>\n  gt::cols_label(party = \"Document\", n = \"Sentence Count\") |>\n  gt::tab_footnote(footnote =  md(\n    \"*Extracted with tabulapdf and tokenized into sentences with tidytext*\"\n  )) |>\n  gtExtras::gt_plt_bar(\n    column = n,\n    keep_column = T,\n    color = paletteer::paletteer_d(\"LaCroixColoR::Pamplemousse\")[5]\n  )\n\n```\n:::\n\n\n\n::: \n\n## Embedding the sentences\n\nAt this point, we are going to leave the r-universe and move over to python, because most state-of-the-art natural language processing libraries are being developed in python. Since this document is written in `quarto`, this is not an issue, as we can easily move back and forth between the different languages and even transfer objects and data.frames with ease! \n\nSentence transformers are a model architecture that excels at representing semantic information of short text chunks (versus single-words). They are frequently used to find similar sentences among large collections of text, e.g. for search engines. They can also be used for paraphrase-mining or evaluating the textual similarity of two strings, taking into account the contextualized meaning of words (e.g. a *theatre play* being something different than a *word play*). \n\nFor a documentation on the library we will use, see the [docs](https://sbert.net/docs/quickstart.html). For a more in-depth explanation of the SBERT architecture see [here](https://www.marqo.ai/course/introduction-to-sentence-transformers) and [here](https://medium.com/@jyotsna.a.choudhary/comprehensive-guide-to-embeddings-from-word-vectors-to-contextualized-representations-part-2-cfd6bc5154c5)\n\nWe will embed each sentence from the documents and then find the most similiar sentences for each party. \n\n\n### Loading the model\n\nTo load the model, we use the `SentenceTransformer` Class and a model that is optimized for multilingual analysis, since our texts are in German, not in English. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nfrom sentence_transformers import SentenceTransformer, util\nimport pandas as pd\nfrom nltk.tokenize import sent_tokenize\nmodel = SentenceTransformer('sentence-transformers/paraphrase-multilingual-mpnet-base-v2')\n\n```\n:::\n\n\n\n### Encoding text\n\nNow we encode the coalition text, using the `.encode` method. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\ncoalition_text = r.sentences[r.sentences['party']=='koalition'].reset_index().text\nembedding_coal = model.encode(coalition_text,\n  convert_to_tensor=True,\n  show_progress_bar = True)\n```\n:::\n\n\nWe transform these to a tensor. It then has a rectangular shape, where each sentence of the coalition agreement receives a numeric score on the 384 dimensions of the  embedding vector from the model. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nembedding_coal.shape\n## torch.Size([3257, 768])\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\nOn dimension 1, sentence 106 (*für einen echten innovationsschub müssen wir ausgründungen vorantreiben\\.*) receives a value of 0.091, whereas sentence 200 (*wir werden hochschulen mittel des bundes zur schaffung einer gründungsinfrastruktur für technologisches wie soziales unternehmertum bereitstellen\\.*) receives a value of 0.0505. Since these embeddings and dimensions are fully computationally determined, we have no simple way of mapping this back to meaningful semantic dimensions, although there have been [attempts](https://ceur-ws.org/Vol-3478/paper69.pdf) at doing so. \n\nWhen comparing the angle between these vectors in their multidimensional embedding space, the larger the value the more similar they are. \n\nWe can do this using the simple `util.pytorch_cos_sim` function. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\ndiff1 = util.pytorch_cos_sim(embedding_coal[401], embedding_coal[402]).cpu().numpy()\ndiff2 = util.pytorch_cos_sim(embedding_coal[401], embedding_coal[105]).cpu().numpy()\n```\n:::\n\n\n\nThe sentences: \n\n- *für einen echten innovationsschub müssen wir ausgründungen vorantreiben\\.*\n\nand \n\n- *wir werden hochschulen mittel des bundes zur schaffung einer gründungsinfrastruktur für technologisches wie soziales unternehmertum bereitstellen\\.*\n\nare not evaluated as very similar (cosine similarity of 0.7142), because they are quite different, but still a lot more similar than the following comparison. \n\n- *für einen echten innovationsschub müssen wir ausgründungen vorantreiben\\.*\n\nand \n\n- *7 eine starke demokratie lebt von den menschen\\, die sie tragen\\.*\n\nyields a lower cosine similarity of 0.2328, as these are semantically quite different. \n\n\n### Encoding all texts and comparing them\n\nIn the following code-chunk, we will repeat the embedding process for each collection of party sentences, then create a matrix with a pair-wise cosine similarity calculation of each coalition sentence with each party sentence. We will keep only the most similar party sentence for each coalition agreement sentence. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nfrom tqdm import tqdm\nimport pandas as pd\nfrom sentence_transformers import util\n\ndata = pd.DataFrame()\n\n\n# Assuming `coalition_text` and `embedding_coal` are precomputed\nfor party in tqdm(['fdp', 'spd', 'gruene'], desc=\"Processing Parties\"):\n    party_text = r.sentences[r.sentences['party'] == party].reset_index(drop=True).text\n    embedding_party = model.encode(party_text, convert_to_tensor=True, show_progress_bar=True)\n    \n    # Compute cosine similarity matrix\n    cosine_scores = util.pytorch_cos_sim(embedding_party, embedding_coal).cpu().numpy()\n\n    # Create a DataFrame for all combinations using vectorized operations\n    rows, cols = cosine_scores.shape\n    results = pd.DataFrame({\n        'party': party,\n        'sentence': party_text.repeat(cols),\n        'sentence_coal': list(coalition_text) * rows,\n        'score': cosine_scores.flatten()\n    })\n\n    # Keep top match for each sentence in party_text\n    top_pair = results.sort_values('score', ascending=False).groupby(['party', 'sentence_coal']).head(1)\n    data = pd.concat([data, top_pair], ignore_index=True)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n\nLooking at the most similar sentences, this has worked remarkably well, the model has identified almost identical sentences that seem to have come from individual party programs. \n\nWhat is clearly visible from this extract is also one large caveat about what we can infer from these metrics. Just because a sentence was copied almost identically from a party program does not mean that the sentence has a high impact on policies. \n\nFor example the sentence: \"die prinzipien offenen regierungshandelns - transparenz, partizipation und zusammenarbeit sind für uns handlungsleitend.\" - the principles of open government action - transparency, participation and cooperation are our guiding principles - is not policy related. This related to the above mentioned caveats. So we need to take care in the conclusions we draw from the following results. \n\n\n::: {.panel-tabset}\n\n## Table\n\n\n\n\n\n::: {#tbl-most_similar_sentences .cell layout-align=\"center\" tbl-cap='Most similar Sentences'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lyncfnhwma\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lyncfnhwma table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lyncfnhwma thead, #lyncfnhwma tbody, #lyncfnhwma tfoot, #lyncfnhwma tr, #lyncfnhwma td, #lyncfnhwma th {\n  border-style: none;\n}\n\n#lyncfnhwma p {\n  margin: 0;\n  padding: 0;\n}\n\n#lyncfnhwma .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lyncfnhwma .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lyncfnhwma .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lyncfnhwma .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lyncfnhwma .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lyncfnhwma .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lyncfnhwma .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lyncfnhwma .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lyncfnhwma .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lyncfnhwma .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lyncfnhwma .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lyncfnhwma .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lyncfnhwma .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lyncfnhwma .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lyncfnhwma .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lyncfnhwma .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lyncfnhwma .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lyncfnhwma .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lyncfnhwma .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lyncfnhwma .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lyncfnhwma .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lyncfnhwma .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lyncfnhwma .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lyncfnhwma .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lyncfnhwma .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lyncfnhwma .gt_left {\n  text-align: left;\n}\n\n#lyncfnhwma .gt_center {\n  text-align: center;\n}\n\n#lyncfnhwma .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lyncfnhwma .gt_font_normal {\n  font-weight: normal;\n}\n\n#lyncfnhwma .gt_font_bold {\n  font-weight: bold;\n}\n\n#lyncfnhwma .gt_font_italic {\n  font-style: italic;\n}\n\n#lyncfnhwma .gt_super {\n  font-size: 65%;\n}\n\n#lyncfnhwma .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lyncfnhwma .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lyncfnhwma .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lyncfnhwma .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lyncfnhwma .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lyncfnhwma .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lyncfnhwma .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lyncfnhwma .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lyncfnhwma div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal\" style><span data-qmd-base64=\"PHN0cm9uZz5Ub3AgMTAgbW9zdCBzaW1pbGFyIHNlbnRlbmNlczwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Top 10 most similar sentences</strong></span></span></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>by cosine similarity</td>\n    </tr>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"party\"><span data-qmd-base64=\"PHN0cm9uZz5QYXJ0eTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Party</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"**Texts**\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"PHN0cm9uZz5UZXh0czwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Texts</strong></span></span></div>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"score\"><span data-qmd-base64=\"PHN0cm9uZz5Db3NpbmUKU2ltaWxhcml0eTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Cosine\nSimilarity</strong></span></span></th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sentence\"><span data-qmd-base64=\"PGVtPlBhcnR5ClByb2dyYW08L2VtPg==\"><span class='gt_from_md'><em>Party\nProgram</em></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sentence_coal\"><span data-qmd-base64=\"PGVtPkNvYWxpdGlvbgpBZ3JlZW1lbnQ8L2VtPg==\"><span class='gt_from_md'><em>Coalition\nAgreement</em></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">alleinerziehende, die heute am stärksten von armut betroffen sind, entlasten wir mit einer steuergutschrift.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">alleinerziehende, die heute am stärksten von armut betroffen sind, entlasten wir mit einer steuergutschrift.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">1.0000</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">sichere und leistungsfähige datenverarbeitung, kombiniert mit mobiler it und klar geregelten kompetenzen, ist dabei eine grundvoraussetzung moderner polizeiarbeit.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">sichere und leistungsfähige datenverarbeitung, kombiniert mit mobiler it und klar geregelten kompetenzen, sind grundvoraussetzung moderner polizeiarbeit.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9984</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">wir setzen uns dafür ein, die rechte von minderheiten auf internationaler ebene zu stärken – auch innerhalb der eu.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir wollen die rechte von minderheiten auf internationaler ebene und insbesondere innerhalb der eu stärken.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9902</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">die prinzipien offenen regierungshandelns - transparenz, partizipation und zusammenarbeit sind für uns handlungsleitend.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">uns leiten die prinzipien offenen regierungshandelns – transparenz, partizipation und zusammenarbeit.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9855</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">die anhaltende bedrohung des staates israel und seiner souveränität in seiner nachbarschaft und den terror gegen seine bevölkerung verurteilen wir.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">die anhaltende bedrohung des staates israel und den terror gegen seine bevölkerung verurteilen wir.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9851</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">einseitige schritte von allen seiten erschweren die friedensbemühungen und müssen unterbleiben.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">einseitige schritte erschweren die friedensbemühungen und müssen unterbleiben.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9842</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">im mittelpunkt stehen dabei der abbau von bürokratiepflichten, die prüfung von investitionsbezuschussungen für produktionsstätten, sowie die prüfung von zuschüssen zur gewährung der versorgungssicherheit.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">dazu gehören der abbau von bürokratie, die prüfung von investitionsbezuschussungen für produktionsstätten, sowie die prüfung von zuschüssen zur gewährung der versorgungssicherheit.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9807</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">wir werden die nationalen aktionspläne im rahmen der open government partnership deutschlands umsetzen und weiterentwickeln.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir wollen die nationalen aktionspläne im rahmen der open-government- partnership (ogp) deutschlands umsetzen und weiterentwickeln.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9765</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">wir setzen uns für einen leistungsstarken europäischen bankenmarkt ein, der durch wettbewerb und vielfalt der geschäftsmodelle geprägt ist.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir setzen uns für einen leistungsstarken europäischen bankensowie kapitalmarkt ein, der durch wettbewerb und vielfalt der geschäftsmodelle geprägt ist.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9759</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">ziel sind 30 prozent ökolandbau bis 2030.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir wollen 30 prozent ökolandbau bis zum jahr 2030 erreichen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9732</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"> <span data-qmd-base64=\"PGVtPkV4Y2x1ZGluZyBzZW50ZW5jZXMgc2hvcnRlciB0aGFuIDIwIGNoYXJhY3RlcnMuPC9lbT4=\"><span class='gt_from_md'><em>Excluding sentences shorter than 20 characters.</em></span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Code \n\n\n\n\n::: {#tbl-most_similar_sentences_code .cell layout-align=\"center\" tbl-cap='Most similar Sentences'}\n\n:::\n\n\n\n::: \n\n\n# Results \n\nTo systematically evaluate the impact of different party programs on the coalition agreement, I will take two simple metrics. \n\n- how many sentences reach an arbitrary high threshold of similarity (*0.8* and *0.9* respectively)? \n- how often does a party have the most similar sentence in a party program in a pairwise comparison with the coalition agreement\n\nIn the following table, we can see that for very similar sentences with a similarity of higher than .9, all parties contributed an almost equal amount of sentences, about 30. If we lower this threshold, we can see that the greens contribute a significantly higher share of similar sentences, almost twice as many as the other coalition partners. This might be due to the party program of the greens being much longer and hence possible accounting for many more variations of similar policy areas or even covering policy areas much more exhaustively. \n\nIf we look at the amount of times the Greens contributed the most fitting sentence for a given sentence in the coalition agreement, the difference is even more staggering. For more than 53% of sentences, the greens are the program that is most similar, with SPD and FDP contributing an almost equal share of the remaining ~\n46%. \n\n::: {.panel-tabset}\n\n## Table\n\n\n\n::: {#tbl-high_scoring_parties .cell layout-align=\"center\" tbl-cap='Highscoring Party Contributions'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mhhwqtnufu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mhhwqtnufu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mhhwqtnufu thead, #mhhwqtnufu tbody, #mhhwqtnufu tfoot, #mhhwqtnufu tr, #mhhwqtnufu td, #mhhwqtnufu th {\n  border-style: none;\n}\n\n#mhhwqtnufu p {\n  margin: 0;\n  padding: 0;\n}\n\n#mhhwqtnufu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mhhwqtnufu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mhhwqtnufu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mhhwqtnufu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mhhwqtnufu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mhhwqtnufu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mhhwqtnufu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mhhwqtnufu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mhhwqtnufu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mhhwqtnufu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mhhwqtnufu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mhhwqtnufu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mhhwqtnufu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mhhwqtnufu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mhhwqtnufu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhhwqtnufu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mhhwqtnufu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mhhwqtnufu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mhhwqtnufu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhhwqtnufu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mhhwqtnufu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhhwqtnufu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mhhwqtnufu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhhwqtnufu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mhhwqtnufu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhhwqtnufu .gt_left {\n  text-align: left;\n}\n\n#mhhwqtnufu .gt_center {\n  text-align: center;\n}\n\n#mhhwqtnufu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mhhwqtnufu .gt_font_normal {\n  font-weight: normal;\n}\n\n#mhhwqtnufu .gt_font_bold {\n  font-weight: bold;\n}\n\n#mhhwqtnufu .gt_font_italic {\n  font-style: italic;\n}\n\n#mhhwqtnufu .gt_super {\n  font-size: 65%;\n}\n\n#mhhwqtnufu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mhhwqtnufu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mhhwqtnufu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mhhwqtnufu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mhhwqtnufu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mhhwqtnufu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mhhwqtnufu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mhhwqtnufu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mhhwqtnufu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal\" style><span data-qmd-base64=\"PHN0cm9uZz5QYXJ0eSBIaWdoIFNjb3Jlczwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Party High Scores</strong></span></span></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>by cosine similarity</td>\n    </tr>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"party\"><span data-qmd-base64=\"PHN0cm9uZz5QYXJ0eTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Party</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"**Similarity &gt;=**\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"PHN0cm9uZz5TaW1pbGFyaXR5ICZndDs9PC9zdHJvbmc+\"><span class='gt_from_md'><strong>Similarity &gt;=</strong></span></span></div>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"highest_score_sentence\"><span data-qmd-base64=\"PHN0cm9uZz5IaWdoZXN0IHNjb3JlIGFjcm9zcyBwYXJ0aWVzPC9zdHJvbmc+\"><span class='gt_from_md'><strong>Highest score across parties</strong></span></span></th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"score_over_80\"><span data-qmd-base64=\"PGVtPi44PC9lbT4=\"><span class='gt_from_md'><em>.8</em></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"score_over_90\"><span data-qmd-base64=\"PGVtPi45PC9lbT4=\"><span class='gt_from_md'><em>.9</em></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"score_over_80\" class=\"gt_row gt_right\">339</td>\n<td headers=\"score_over_90\" class=\"gt_row gt_right\">25</td>\n<td headers=\"highest_score_sentence\" class=\"gt_row gt_right\">744</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"score_over_80\" class=\"gt_row gt_right\">656</td>\n<td headers=\"score_over_90\" class=\"gt_row gt_right\">33</td>\n<td headers=\"highest_score_sentence\" class=\"gt_row gt_right\">1718</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"score_over_80\" class=\"gt_row gt_right\">386</td>\n<td headers=\"score_over_90\" class=\"gt_row gt_right\">36</td>\n<td headers=\"highest_score_sentence\" class=\"gt_row gt_right\">731</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"> <span data-qmd-base64=\"PGVtPk9mIGEgdG90YWwgb2YgMzE5MyBzZW50ZW5jZXMgaW4gdGhlIGNvYWxpdGlvbiBhZ3JlZW1lbnQuIEV4Y2x1ZGluZyBzZW50ZW5jZXMgc2hvcnRlciB0aGFuIDIwIGNoYXJhY3RlcnMuPC9lbT4=\"><span class='gt_from_md'><em>Of a total of 3193 sentences in the coalition agreement. Excluding sentences shorter than 20 characters.</em></span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Code\n\n\n::: {#tbl-high_scoring_parties_code .cell layout-align=\"center\" tbl-cap='Highscoring Party Contributions'}\n\n```{.r .cell-code}\n\nclean_data |> \n  group_by(sentence_coal) |> \n  mutate(score_over_90= score >=.9,\n         score_over_80= score >=.8,\n         highest_score_sentence = score == max(score)) |> \n  group_by(party) |> \n  summarise(score_over_90 = sum(score_over_90),\n            score_over_80 = sum(score_over_80),\n            highest_score_sentence = sum(highest_score_sentence)) |> \n  gt::gt()|> \n  gt::cols_label(\n    party = md(\"**Party**\"), \n    score_over_80 = md(\"*.8*\"),\n    score_over_90 = md(\"*.9*\"),\n    highest_score_sentence = md(\"**Highest score across parties**\")\n  ) |> \n  gt::tab_header(title = md(\"**Party High Scores**\"), subtitle = \"by cosine similarity\") |> \n  tab_footnote(md(glue(\"*Of a total of {nrow(clean_data)/3} sentences in the coalition agreement. Excluding sentences shorter than 20 characters.*\")))|>\n  tab_spanner(label = md(\"**Similarity >=**\"), columns = c(\"score_over_80\", \"score_over_90\"))\n```\n:::\n\n\n:::\n\nIf we look at this through the lens of the distribution of similarity scores this picture becomes more nuanced. It is clearly visible that the greens have a higher median score, in 50% of the cases between 0.7 and 0.8 round about, but it becomes clear that the most similar sentence might not always be the most similar by far or the decision might be far from clear. \n\n::: {.panel-tabset}\n\n## Plot\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Distribution of sentence similarity scores](index_files/figure-html/fig-1-density-plot-1.png){#fig-1-density-plot fig-align='center' width=90%}\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n\nggplot(clean_data)+\n  geom_violin(aes(toupper(party), score, fill = party), show.legend = FALSE) +\n  geom_boxplot(aes(toupper(party), score), show.legend = FALSE) +\n  theme_minimal()+\n  scale_fill_manual(\n                    values = list(\n    \"FDP\" = paletteer::paletteer_d(\"lisa::FridaKahlo\")[4],\n    \"GRUENE\" = paletteer::paletteer_d(\"lisa::FridaKahlo\")[2],\n    \"SPD\" = paletteer::paletteer_d(\"lisa::FridaKahlo\")[5]\n  )) +\n  labs(title = \"Distribution of sentence similarity scores\", subtitle = \"across parties\",  x = \"\", y = \"Similarity Score\") +\n  scale_y_continuous(breaks = seq(0,1,0.1))\n```\n:::\n\n\n\n:::\n\nIf we want to validate this a bit further it makes sense to look at two groups of sentences. One, where the variance of scores in between the most similar sentence for each party is high, hence we would explain a clear winner of one party program that contributed. Two, where the variance is very little, to see how well our sentence similarity scores for cases where all three party programs are all related to the coalition agreement to a similar degree. \n\nFor the first case, we look at three sentences, where the variance is high. In two, the greens win by far, because they simply contributed this specific sentence which does not even appear remotely related to any sentence in the other party programs. In the third case, related to a minimum wage, the SPD takes the crown by a small margin. This is actually not really true. Qualitatively the sentence of the greens is more similar, as it simply states the raising of a minimum wage to 12€ (although it mentions to so immediately, which is absent from the coalition agreement), the SPD goes much further to imply that they want to raise it beyond 12€ eventually, which in the wording of the coalition agreement is clearly ruled out (one-time raise). Hence I would qualitatively say the greens are closer, however this is an edge case where both parties have clearly contributed to the agreement. \n\n::: {.panel-tabset}\n\n## Table\n\n\n\n::: {#tbl-highest-variance_table .cell layout-align=\"center\" tbl-cap='Highest variance in scores'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"amvpsauuvj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#amvpsauuvj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#amvpsauuvj thead, #amvpsauuvj tbody, #amvpsauuvj tfoot, #amvpsauuvj tr, #amvpsauuvj td, #amvpsauuvj th {\n  border-style: none;\n}\n\n#amvpsauuvj p {\n  margin: 0;\n  padding: 0;\n}\n\n#amvpsauuvj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#amvpsauuvj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#amvpsauuvj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#amvpsauuvj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#amvpsauuvj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#amvpsauuvj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#amvpsauuvj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#amvpsauuvj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#amvpsauuvj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#amvpsauuvj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#amvpsauuvj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#amvpsauuvj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#amvpsauuvj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#amvpsauuvj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#amvpsauuvj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#amvpsauuvj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#amvpsauuvj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#amvpsauuvj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#amvpsauuvj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#amvpsauuvj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#amvpsauuvj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#amvpsauuvj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#amvpsauuvj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#amvpsauuvj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#amvpsauuvj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#amvpsauuvj .gt_left {\n  text-align: left;\n}\n\n#amvpsauuvj .gt_center {\n  text-align: center;\n}\n\n#amvpsauuvj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#amvpsauuvj .gt_font_normal {\n  font-weight: normal;\n}\n\n#amvpsauuvj .gt_font_bold {\n  font-weight: bold;\n}\n\n#amvpsauuvj .gt_font_italic {\n  font-style: italic;\n}\n\n#amvpsauuvj .gt_super {\n  font-size: 65%;\n}\n\n#amvpsauuvj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#amvpsauuvj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#amvpsauuvj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#amvpsauuvj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#amvpsauuvj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#amvpsauuvj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#amvpsauuvj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#amvpsauuvj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#amvpsauuvj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style><span data-qmd-base64=\"PHN0cm9uZz5IaWdoZXN0IHZhcmlhbmNlIGluIHNjb3Jlczwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Highest variance in scores</strong></span></span></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>by variance of cosine similarity</td>\n    </tr>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"party\"><span data-qmd-base64=\"PHN0cm9uZz5QYXJ0eTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Party</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"**Texts**\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"PHN0cm9uZz5UZXh0czwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Texts</strong></span></span></div>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"score\"><span data-qmd-base64=\"PHN0cm9uZz5Db3NpbmUKU2ltaWxhcml0eTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Cosine\nSimilarity</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"variance\"><span data-qmd-base64=\"PHN0cm9uZz5WYXJpYW5jZTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Variance</strong></span></span></th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sentence\"><span data-qmd-base64=\"PGVtPlBhcnR5ClByb2dyYW08L2VtPg==\"><span class='gt_from_md'><em>Party\nProgram</em></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sentence_coal\"><span data-qmd-base64=\"PGVtPkNvYWxpdGlvbgpBZ3JlZW1lbnQ8L2VtPg==\"><span class='gt_from_md'><em>Coalition\nAgreement</em></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">machen wir den weg frei für diese entwicklung!</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir treiben die un-dekade für menschen afrikanischer herkunft voran (z.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.6156</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.04478</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">die partnerschaft zwischen europa und afrika wollen wir politisch und wirtschaftlich deutlich ausbauen und auf ein neues level der zusammenarbeit heben.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir treiben die un-dekade für menschen afrikanischer herkunft voran (z.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.5927</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.04478</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">deshalb wollen wir die un-dekade für menschen afrikanischer herkunft vorantreiben.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir treiben die un-dekade für menschen afrikanischer herkunft voran (z.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9701</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.04478</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">wir brauchen land- und forstwirtschaft, die nachhaltig ist und flächen, die zusätzliche beiträge zum naturschutz leisten.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir wollen 30 prozent ökolandbau bis zum jahr 2030 erreichen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.5922</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.04361</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">dementsprechend werden wir im einklang mit den europäischen klimazielen unser minderungsziel für 2030 deutlich (auf 65 %) anheben; auch für 2040 werden wir ein minderungsziel festschreiben (88 %).</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir wollen 30 prozent ökolandbau bis zum jahr 2030 erreichen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.6347</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.04361</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">ziel sind 30 prozent ökolandbau bis 2030.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">wir wollen 30 prozent ökolandbau bis zum jahr 2030 erreichen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.9732</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.04361</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">die mindest- und maximalbeträge wollen wir erhöhen, auch als inflationsausgleich.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">mindestlohn wir werden den gesetzlichen mindestlohn in einer einmaligen anpassung auf zwölf euro pro stunde erhöhen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.5519</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.03752</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">wir werden den gesetzlichen mindestlohn zunächst auf mindestens zwölf euro erhöhen und die spielräume der mindestlohnkommission für künftige erhöhungen ausweiten.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">mindestlohn wir werden den gesetzlichen mindestlohn in einer einmaligen anpassung auf zwölf euro pro stunde erhöhen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.8980</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.03752</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">den gesetzlichen mindestlohn werden wir sofort auf 12 euro anheben.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">mindestlohn wir werden den gesetzlichen mindestlohn in einer einmaligen anpassung auf zwölf euro pro stunde erhöhen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.8756</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">0.03752</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"> <span data-qmd-base64=\"PGVtPkV4Y2x1ZGluZyBzZW50ZW5jZXMgc2hvcnRlciB0aGFuIDIwIGNoYXJhY3RlcnMuPC9lbT4=\"><span class='gt_from_md'><em>Excluding sentences shorter than 20 characters.</em></span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {#tbl-highest-variance_code .cell layout-align=\"center\" tbl-cap='Highest variance in scores'}\n\n```{.r .cell-code}\nclean_data |> \n  group_by(sentence_coal) |> \n  mutate(variance = var(score)) |> \n  ungroup() |> \n  slice_max(order_by = variance, n = 7) |> \n  gt::gt()|> \n  gt::cols_label(\n    party = md(\"**Party**\"), \n    sentence = md(\"*Party \\nProgram*\"),\n    sentence_coal = md(\"*Coalition \\nAgreement*\"),\n    score = md(\"**Cosine \\nSimilarity**\"),\n    variance = md(\"**Variance**\"),\n  ) |> \n  gt::tab_header(title = md(\"**Highest variance in scores**\"), subtitle = \"by variance of cosine similarity\") |> \n  tab_footnote(md(\"*Excluding sentences shorter than 20 characters.*\"))|>\n  tab_spanner(label = md(\"**Texts**\"), columns = c(\"sentence\", \"sentence_coal\"))\n```\n:::\n\n\n:::\n\n\nIf we look at the sentences with the lowest variance, we would expect the estimation of perform even worse. When there is three sentences that are equally similar, it might not be possibly to predict from this a perfect match, the resulting sentence might be a mix of different sentences or be completely void of content or unrelated to any of the party programs. This is the case in the below three cases. \n\n\n::: {.panel-tabset}\n\n## Table\n\n\n\n::: {#tbl-lowest-variance_table .cell layout-align=\"center\" tbl-cap='Lowest variance in scores'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ugacuugqja\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ugacuugqja table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ugacuugqja thead, #ugacuugqja tbody, #ugacuugqja tfoot, #ugacuugqja tr, #ugacuugqja td, #ugacuugqja th {\n  border-style: none;\n}\n\n#ugacuugqja p {\n  margin: 0;\n  padding: 0;\n}\n\n#ugacuugqja .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ugacuugqja .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ugacuugqja .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ugacuugqja .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ugacuugqja .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ugacuugqja .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ugacuugqja .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ugacuugqja .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ugacuugqja .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ugacuugqja .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ugacuugqja .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ugacuugqja .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ugacuugqja .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ugacuugqja .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ugacuugqja .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugacuugqja .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ugacuugqja .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ugacuugqja .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ugacuugqja .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugacuugqja .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ugacuugqja .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugacuugqja .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ugacuugqja .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugacuugqja .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ugacuugqja .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugacuugqja .gt_left {\n  text-align: left;\n}\n\n#ugacuugqja .gt_center {\n  text-align: center;\n}\n\n#ugacuugqja .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ugacuugqja .gt_font_normal {\n  font-weight: normal;\n}\n\n#ugacuugqja .gt_font_bold {\n  font-weight: bold;\n}\n\n#ugacuugqja .gt_font_italic {\n  font-style: italic;\n}\n\n#ugacuugqja .gt_super {\n  font-size: 65%;\n}\n\n#ugacuugqja .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ugacuugqja .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ugacuugqja .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ugacuugqja .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ugacuugqja .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ugacuugqja .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ugacuugqja .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ugacuugqja .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ugacuugqja div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style><span data-qmd-base64=\"PHN0cm9uZz5Mb3dlc3QgdmFyaWFuY2UgaW4gc2NvcmVzPC9zdHJvbmc+\"><span class='gt_from_md'><strong>Lowest variance in scores</strong></span></span></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>by variance of cosine similarity</td>\n    </tr>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"party\"><span data-qmd-base64=\"PHN0cm9uZz5QYXJ0eTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Party</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"**Texts**\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"PHN0cm9uZz5UZXh0czwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Texts</strong></span></span></div>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"score\"><span data-qmd-base64=\"PHN0cm9uZz5Db3NpbmUKU2ltaWxhcml0eTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Cosine\nSimilarity</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"variance\"><span data-qmd-base64=\"PHN0cm9uZz5WYXJpYW5jZTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Variance</strong></span></span></th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sentence\"><span data-qmd-base64=\"PGVtPlBhcnR5ClByb2dyYW08L2VtPg==\"><span class='gt_from_md'><em>Party\nProgram</em></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sentence_coal\"><span data-qmd-base64=\"PGVtPkNvYWxpdGlvbgpBZ3JlZW1lbnQ8L2VtPg==\"><span class='gt_from_md'><em>Coalition\nAgreement</em></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">ebenso kann es sinnvoll sein, künftig stärker mit von der steuerschuld abzuziehenden - steuergutschriften zu arbeiten.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">entsprechend wird die befüllung eines sondervermögens als abfluss aus dem kernhaushalt den verschuldungsspielraum reduzieren.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.7276</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">4.171e-07</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">durch ausgeweitete vorsorgende beratungsmöglichkeiten soll der weg in die überschuldung am besten von vornherein vermieden werden.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">entsprechend wird die befüllung eines sondervermögens als abfluss aus dem kernhaushalt den verschuldungsspielraum reduzieren.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.7269</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">4.171e-07</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">überhöhte dispozinsen und gebühren, insbesondere für das basiskonto, werden wir begrenzen.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">entsprechend wird die befüllung eines sondervermögens als abfluss aus dem kernhaushalt den verschuldungsspielraum reduzieren.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.7263</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">4.171e-07</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">das parlament kann ihr oder ihm durch die mehrheit seiner mitglieder das misstrauen aussprechen und eine andere person zum kommissionspräsidenten wählen.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">ihre leitung wird vom bundestag gewählt.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.6308</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">2.785e-06</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">für bestehende ehen werden wir zudem ein wahlrecht einführen.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">ihre leitung wird vom bundestag gewählt.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.6336</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">2.785e-06</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">das gilt erst recht für diese bundestagswahl am 26.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">ihre leitung wird vom bundestag gewählt.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.6337</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">2.785e-06</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">FDP</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">zukunftsfähige und starke europäische union europa muss bereit sein, die großen herausforderungen unserer zeit zu bewältigen – die folgen der coronapandemie, den klimawandel, terrorismus und migration.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">die großen herausforderungen unserer zeit lassen sich nur in internationaler kooperation und gemeinsam in einer starken europäischen union bewältigen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.8151</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">3.400e-06</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">SPD</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">die europäische zusammenarbeit werden wir ausbauen.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">die großen herausforderungen unserer zeit lassen sich nur in internationaler kooperation und gemeinsam in einer starken europäischen union bewältigen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.8145</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">3.400e-06</td></tr>\n    <tr><td headers=\"party\" class=\"gt_row gt_left\">GRUENE</td>\n<td headers=\"sentence\" class=\"gt_row gt_left\">soweit europäische einigungen nicht gelingen, gehen wir voran, in verstärkter zusammenarbeit oder gemeinsam mit einzelnen staaten.</td>\n<td headers=\"sentence_coal\" class=\"gt_row gt_left\">die großen herausforderungen unserer zeit lassen sich nur in internationaler kooperation und gemeinsam in einer starken europäischen union bewältigen.</td>\n<td headers=\"score\" class=\"gt_row gt_right\">0.8179</td>\n<td headers=\"variance\" class=\"gt_row gt_right\">3.400e-06</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"> <span data-qmd-base64=\"PGVtPkV4Y2x1ZGluZyBzZW50ZW5jZXMgc2hvcnRlciB0aGFuIDIwIGNoYXJhY3RlcnMuPC9lbT4=\"><span class='gt_from_md'><em>Excluding sentences shorter than 20 characters.</em></span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {#tbl-lowest-variance_code .cell layout-align=\"center\" tbl-cap='Lowest variance in scores'}\n\n```{.r .cell-code}\nclean_data |> \n  group_by(sentence_coal) |> \n  mutate(variance = var(score)) |> \n  ungroup() |> \n  slice_min(order_by = variance, n = 7) |> \n  gt::gt()|> \n  gt::cols_label(\n    party = md(\"**Party**\"), \n    sentence = md(\"*Party \\nProgram*\"),\n    sentence_coal = md(\"*Coalition \\nAgreement*\"),\n    score = md(\"**Cosine \\nSimilarity**\"),\n    variance = md(\"**Variance**\"),\n  ) |> \n  gt::tab_header(title = md(\"**Lowest variance in scores**\"), subtitle = \"by variance of cosine similarity\") |> \n  tab_footnote(md(\"*Excluding sentences shorter than 20 characters.*\"))|>\n  tab_spanner(label = md(\"**Texts**\"), columns = c(\"sentence\", \"sentence_coal\"))\n\n```\n:::\n\n\n:::\n\nHence we need to draw the conclusion that our metric of looking at a winner across the three parties probably overestimates the contribution of the greens by far, by artificially introducing a sort of winner takes it all mechanism that benefits longer party programs and larger lexical diversity. \n\nNonetheless, we can say that the greens have, even though they were only the second largest coalition partner greatly contributed to the wording of the coalition agreement. \n\nIn a follow-up blog entry, I will look at the issues at stake and look at how we can possibly extend this analysis. \n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}